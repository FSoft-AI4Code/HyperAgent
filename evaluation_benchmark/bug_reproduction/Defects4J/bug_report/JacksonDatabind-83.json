{"issue_id": "1629", "title": "<code>FromStringDeserializer</code> ignores registered <code>DeserializationProblemHandler</code> for <code>java.util.UUID</code>", "description": "\n<p dir=\"auto\">Culprit appears to be <a href=\"https://github.com/FasterXML/jackson-databind/blob/60ae6000d361f910ab0d7d269a5bac1fc66f4cd9/src/main/java/com/fasterxml/jackson/databind/deser/std/FromStringDeserializer.java#L155-L161\">lines 155-161 of FromStringDeserializer</a>:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"            // 05-May-2016, tatu: Unlike most usage, this seems legit, so...\n            JsonMappingException e = ctxt.weirdStringException(text, _valueClass, msg);\n            if (cause != null) {\n                e.initCause(cause);\n            }\n            throw e;\n            // nothing to do here, yet? We'll fail anyway\"><pre class=\"notranslate\"><code>            // 05-May-2016, tatu: Unlike most usage, this seems legit, so...\n            JsonMappingException e = ctxt.weirdStringException(text, _valueClass, msg);\n            if (cause != null) {\n                e.initCause(cause);\n            }\n            throw e;\n            // nothing to do here, yet? We'll fail anyway\n</code></pre></div>\n<p dir=\"auto\">The above lines appear to show that the exception will be thrown regardless of any problem handling logic.</p>\n<p dir=\"auto\">Test Case:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='import com.fasterxml.jackson.databind.DeserializationContext;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.deser.DeserializationProblemHandler;\nimport org.junit.Test;\n\nimport java.io.IOException;\nimport java.util.UUID;\n\npublic class UUIDDeserializerTest {\n\n\n  @Test\n  public void itUsesDeserializationProblemHandlerProperly() throws IOException {\n    ObjectMapper mapper = new ObjectMapper().addHandler(new DeserializationProblemHandler() {\n      @Override\n      public Object handleWeirdStringValue(final DeserializationContext ctxt, final Class&lt;?&gt; targetType, final String valueToConvert, final String failureMsg) throws IOException {\n        return null;\n      }\n    });\n\n    mapper.readValue(\"{\\\"id\\\" : \\\"I am not a UUID\\\"}\", IdBean.class);\n\n\n\n  }\n\n  public static class IdBean {\n    private UUID id;\n\n    public UUID getId() {\n      return id;\n    }\n\n    public void setId(final UUID id) {\n      this.id = id;\n    }\n  }\n}'><pre class=\"notranslate\"><code>import com.fasterxml.jackson.databind.DeserializationContext;\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport com.fasterxml.jackson.databind.deser.DeserializationProblemHandler;\nimport org.junit.Test;\n\nimport java.io.IOException;\nimport java.util.UUID;\n\npublic class UUIDDeserializerTest {\n\n\n  @Test\n  public void itUsesDeserializationProblemHandlerProperly() throws IOException {\n    ObjectMapper mapper = new ObjectMapper().addHandler(new DeserializationProblemHandler() {\n      @Override\n      public Object handleWeirdStringValue(final DeserializationContext ctxt, final Class&lt;?&gt; targetType, final String valueToConvert, final String failureMsg) throws IOException {\n        return null;\n      }\n    });\n\n    mapper.readValue(\"{\\\"id\\\" : \\\"I am not a UUID\\\"}\", IdBean.class);\n\n\n\n  }\n\n  public static class IdBean {\n    private UUID id;\n\n    public UUID getId() {\n      return id;\n    }\n\n    public void setId(final UUID id) {\n      this.id = id;\n    }\n  }\n}\n</code></pre></div>\n<p dir=\"auto\">The handler handles the issue properly; but an exception is thrown anyway:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='an not deserialize value of type java.util.UUID from String \"I am not a UUID\": not a valid textual representation\n at [Source: (String)\"{\"id\" : \"I am not a UUID\"}\"; line: 1, column: 9] (through reference chain: com.company.test.UUIDDeserializerTest$IdBean[\"id\"])\ncom.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type java.util.UUID from String \"I am not a UUID\": not a valid textual representation\n at [Source: (String)\"{\"id\" : \"I am not a UUID\"}\"; line: 1, column: 9] (through reference chain: com.company.test.UUIDDeserializerTest$IdBean[\"id\"])\n\tat com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)\n\tat com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1504)\n\tat com.fasterxml.jackson.databind.deser.std.FromStringDeserializer.deserialize(FromStringDeserializer.java:156)\n\tat com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:127)\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:287)\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:151)\n\tat com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3999)\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2980)'><pre class=\"notranslate\"><code>an not deserialize value of type java.util.UUID from String \"I am not a UUID\": not a valid textual representation\n at [Source: (String)\"{\"id\" : \"I am not a UUID\"}\"; line: 1, column: 9] (through reference chain: com.company.test.UUIDDeserializerTest$IdBean[\"id\"])\ncom.fasterxml.jackson.databind.exc.InvalidFormatException: Can not deserialize value of type java.util.UUID from String \"I am not a UUID\": not a valid textual representation\n at [Source: (String)\"{\"id\" : \"I am not a UUID\"}\"; line: 1, column: 9] (through reference chain: com.company.test.UUIDDeserializerTest$IdBean[\"id\"])\n\tat com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatException.java:67)\n\tat com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(DeserializationContext.java:1504)\n\tat com.fasterxml.jackson.databind.deser.std.FromStringDeserializer.deserialize(FromStringDeserializer.java:156)\n\tat com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(MethodProperty.java:127)\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDeserializer.java:287)\n\tat com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:151)\n\tat com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3999)\n\tat com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:2980)\n</code></pre></div>\n"}