{"issue_id": "MATH-286", "title": "SimplexSolver not working as expected?", "description": "\n<div class=\"user-content-block\">\n<p>I guess (but I could be wrong) that SimplexSolver does not always return the optimal solution, nor satisfies all the constraints...</p>\n<p>Consider this LP:</p>\n<p>max: 0.8 x0 + 0.2 x1 + 0.7 x2 + 0.3 x3 + 0.6 x4 + 0.4 x5;<br/>\nr1: x0 + x2 + x4 = 23.0;<br/>\nr2: x1 + x3 + x5 = 23.0;<br/>\nr3: x0 &gt;= 10.0;<br/>\nr4: x2 &gt;= 8.0;<br/>\nr5: x4 &gt;= 5.0;</p>\n<p>LPSolve returns 25.8, with x0 = 10.0, x1 = 0.0, x2 = 8.0, x3 = 0.0, x4 = 5.0, x5 = 23.0;</p>\n<p>The same LP expressed in Apache commons math is:</p>\n<p>LinearObjectiveFunction f = new LinearObjectiveFunction(new double[] </p>\n{ 0.8, 0.2, 0.7, 0.3, 0.6, 0.4 }\n<p>, 0 );<br/>\nCollection&lt;LinearConstraint&gt; constraints = new ArrayList&lt;LinearConstraint&gt;();<br/>\nconstraints.add(new LinearConstraint(new double[] </p>\n{ 1, 0, 1, 0, 1, 0 }\n<p>, Relationship.EQ, 23.0));<br/>\nconstraints.add(new LinearConstraint(new double[] </p>\n{ 0, 1, 0, 1, 0, 1 }\n<p>, Relationship.EQ, 23.0));<br/>\nconstraints.add(new LinearConstraint(new double[] </p>\n{ 1, 0, 0, 0, 0, 0 }\n<p>, Relationship.GEQ, 10.0));<br/>\nconstraints.add(new LinearConstraint(new double[] </p>\n{ 0, 0, 1, 0, 0, 0 }\n<p>, Relationship.GEQ, 8.0));<br/>\nconstraints.add(new LinearConstraint(new double[] </p>\n{ 0, 0, 0, 0, 1, 0 }\n<p>, Relationship.GEQ, 5.0));</p>\n<p>RealPointValuePair solution = new SimplexSolver().optimize(f, constraints, GoalType.MAXIMIZE, true);</p>\n<p>that returns 22.20, with x0 = 15.0, x1 = 23.0, x2 = 8.0, x3 = 0.0, x4 = 0.0, x5 = 0.0;</p>\n<p>Is it possible SimplexSolver is buggy that way? The returned value is 22.20 instead of 25.8, and the last constraint (x4 &gt;= 5.0) is not satisfied...</p>\n<p>Am I using the interface wrongly?</p>\n</div>\n"}