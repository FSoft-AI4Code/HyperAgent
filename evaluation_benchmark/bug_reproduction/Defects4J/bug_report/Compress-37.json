{"issue_id": "COMPRESS-355", "title": "Parsing PAX headers fails with NegativeArraySizeException", "description": "\n<div class=\"user-content-block\">\n<p>The <tt>TarArchiveInputStream.parsePaxHeaders</tt> method fails with a <tt>NegativeArraySizeException</tt> when there is an empty line at the end of the headers.</p>\n<p>The inner loop starts reading the length, but it gets a newline (10) and ends up subtracting '0' (48) from it; the result is a negative length that blows up an attempt to allocate the <tt>rest</tt> array.</p>\n<p>I would say that a check to see if <tt>ch</tt> is less the '0' and break the loop if it is.</p>\n<p>I used <tt>npm pack aws-sdk@2.2.16</tt> to generate a tarball with this issue.</p>\n</div>\n"}