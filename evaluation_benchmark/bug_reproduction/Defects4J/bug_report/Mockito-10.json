{"issue_id": "99", "title": "RETURNS_DEEP_STUBS automatically tries to create serializable mocks", "description": "\n<p dir=\"auto\">I am just migrating from mockito 1.9.5 to 1.10.5</p>\n<p dir=\"auto\">The following code runs fine with version 1.9.5. but breaks now:</p>\n<div class=\"highlight highlight-source-java notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='\n  @Test\n  public void test() {\n    ToBeMocked mock = mock(ToBeMocked.class, RETURNS_DEEP_STUBS);\n    assertThat(mock.getSomething()).isNotNull();\n  }\n\n  public static class ToBeMocked {\n\n    NotSerializableReturnValue field1;\n\n    public ToBeMocked(NotSerializableReturnValue field1) {\n      this.field1 = field1;\n    }\n\n    public NotSerializableReturnValue getSomething() {\n      return field1;\n    }\n  }\n\n  public static class NotSerializableReturnValue {\n\n    String field1 = \"\";\n\n    public NotSerializableReturnValue(String field1) {\n      this.field1 = field1;\n    }\n\n    public String getSomething2() {\n      return field1;\n    }\n  }'><pre>  <span class=\"pl-c1\">@</span><span class=\"pl-c1\">Test</span>\n  <span class=\"pl-k\">public</span> <span class=\"pl-smi\">void</span> <span class=\"pl-s1\">test</span>() {\n    <span class=\"pl-smi\">ToBeMocked</span> <span class=\"pl-s1\">mock</span> = <span class=\"pl-en\">mock</span>(<span class=\"pl-smi\">ToBeMocked</span>.<span class=\"pl-s1\">class</span>, <span class=\"pl-c1\">RETURNS_DEEP_STUBS</span>);\n    <span class=\"pl-en\">assertThat</span>(<span class=\"pl-s1\">mock</span>.<span class=\"pl-en\">getSomething</span>()).<span class=\"pl-en\">isNotNull</span>();\n  }\n\n  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-smi\">ToBeMocked</span> {\n\n    <span class=\"pl-smi\">NotSerializableReturnValue</span> <span class=\"pl-s1\">field1</span>;\n\n    <span class=\"pl-k\">public</span> <span class=\"pl-smi\">ToBeMocked</span>(<span class=\"pl-smi\">NotSerializableReturnValue</span> <span class=\"pl-s1\">field1</span>) {\n      <span class=\"pl-smi\">this</span>.<span class=\"pl-s1\">field1</span> = <span class=\"pl-s1\">field1</span>;\n    }\n\n    <span class=\"pl-k\">public</span> <span class=\"pl-smi\">NotSerializableReturnValue</span> <span class=\"pl-en\">getSomething</span>() {\n      <span class=\"pl-k\">return</span> <span class=\"pl-s1\">field1</span>;\n    }\n  }\n\n  <span class=\"pl-k\">public</span> <span class=\"pl-k\">static</span> <span class=\"pl-k\">class</span> <span class=\"pl-smi\">NotSerializableReturnValue</span> {\n\n    <span class=\"pl-smi\">String</span> <span class=\"pl-s1\">field1</span> = <span class=\"pl-s\">\"\"</span>;\n\n    <span class=\"pl-k\">public</span> <span class=\"pl-smi\">NotSerializableReturnValue</span>(<span class=\"pl-smi\">String</span> <span class=\"pl-s1\">field1</span>) {\n      <span class=\"pl-smi\">this</span>.<span class=\"pl-s1\">field1</span> = <span class=\"pl-s1\">field1</span>;\n    }\n\n    <span class=\"pl-k\">public</span> <span class=\"pl-smi\">String</span> <span class=\"pl-en\">getSomething2</span>() {\n      <span class=\"pl-k\">return</span> <span class=\"pl-s1\">field1</span>;\n    }\n  }</pre></div>\n<p dir=\"auto\">org.mockito.exceptions.base.MockitoException:<br/>\nYou are using the setting 'withSettings().serializable()' however the type you are trying to mock 'NotSerializableReturnValue'<br/>\ndo not implement Serializable AND do not have a no-arg constructor.</p>\n"}