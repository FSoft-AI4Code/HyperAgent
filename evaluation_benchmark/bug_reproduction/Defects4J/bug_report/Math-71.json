{"issue_id": "MATH-358", "title": "ODE integrator goes past specified end of integration range", "description": "\n<div class=\"user-content-block\">\n<p>End of integration range in ODE solving is handled as an event.<br/>\nIn some cases, numerical accuracy in events detection leads to error in events location.<br/>\nThe following test case shows the end event is not handled properly and an integration that should cover a 60s range in fact covers a 160s range, more than twice the specified range.</p>\n<div class=\"code panel\" style=\"border-width: 1px;\"><div class=\"codeContent panelContent\">\n<pre class=\"code-java\">  <span class=\"code-keyword\">public</span> void testMissedEvent() <span class=\"code-keyword\">throws</span> IntegratorException, DerivativeException {\n          <span class=\"code-keyword\">final</span> <span class=\"code-object\">double</span> t0 = 1878250320.0000029;\n          <span class=\"code-keyword\">final</span> <span class=\"code-object\">double</span> t =  1878250379.9999986;\n          FirstOrderDifferentialEquations ode = <span class=\"code-keyword\">new</span> FirstOrderDifferentialEquations() {\n            \n            <span class=\"code-keyword\">public</span> <span class=\"code-object\">int</span> getDimension() {\n                <span class=\"code-keyword\">return</span> 1;\n            }\n            \n            <span class=\"code-keyword\">public</span> void computeDerivatives(<span class=\"code-object\">double</span> t, <span class=\"code-object\">double</span>[] y, <span class=\"code-object\">double</span>[] yDot)\n                <span class=\"code-keyword\">throws</span> DerivativeException {\n                yDot[0] = y[0] * 1.0e-6;\n            }\n        };\n\n        DormandPrince853Integrator integrator = <span class=\"code-keyword\">new</span> DormandPrince853Integrator(0.0, 100.0,\n                                                                               1.0e-10, 1.0e-10);\n\n        <span class=\"code-object\">double</span>[] y = { 1.0 };\n        integrator.setInitialStepSize(60.0);\n        <span class=\"code-object\">double</span> finalT = integrator.integrate(ode, t0, y, t, y);\n        Assert.assertEquals(t, finalT, 1.0e-6);\n    }\n\n</pre>\n</div></div>\n</div>\n"}