{"issue_id": "618", "title": "A small bug for duplicate tuple in response header", "description": "\n<p dir=\"auto\">for response headers have duplicate tuple\uff0c<br/>\nin this case<br/>\nX-Powered-By:PHP/5.2.8<br/>\nX-Powered-By:ASP.NET</p>\n<p dir=\"auto\">Jsoup can only get the second one<br/>\nif I run header\uff08\u201cX-powered-by\u201d\uff09<br/>\nI got Asp.NET</p>\n<p dir=\"auto\">URL\uff1a<a href=\"http://01pt.com/\" rel=\"nofollow\">http://01pt.com/</a></p>\n<p dir=\"auto\">Cache-Control:no-store, no-cache, must-revalidate, post-check=0, pre-check=0<br/>\nContent-Encoding:gzip<br/>\nContent-Length:16224<br/>\nContent-Type:text/html;charset=gb2312<br/>\nDate:Thu, 27 Aug 2015 09:22:40 GMT<br/>\nExpires:Thu, 19 Nov 1981 08:52:00 GMT<br/>\nPragma:no-cache<br/>\nServer:Microsoft-IIS/7.5<br/>\nVary:Accept-Encoding<br/>\nX-Powered-By:PHP/5.2.8<br/>\nX-Powered-By:ASP.NET</p>\n<p dir=\"auto\">The bug is because<br/>\nif (!values.isEmpty()) header(name, values.get(0));</p>\n<p dir=\"auto\">I change it to<br/>\nif (!values.isEmpty()) {<br/>\nString val = \"\";<br/>\nfor(String str: values) {<br/>\nval = val.concat(str).concat(\" \");</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"                    }\n                    header(name, val);\n              }\"><pre class=\"notranslate\"><code>                    }\n                    header(name, val);\n              }\n</code></pre></div>\n<p dir=\"auto\">then I am able to get \u201cPHP/5.2.8 ASP.NET\u201d when I run header\uff08\u201cX-powered-by\u201d\uff09</p>\n<p dir=\"auto\">void processResponseHeaders(Map&lt;String, List&gt; resHeaders) {<br/>\nfor (Map.Entry&lt;String, List&gt; entry : resHeaders.entrySet()) {<br/>\nString name = entry.getKey();<br/>\nif (name == null)<br/>\ncontinue; // http/1.1 line</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content=\"            List&lt;String&gt; values = entry.getValue();\n            if (name.equalsIgnoreCase(&quot;Set-Cookie&quot;)) {\n                for (String value : values) {\n                    if (value == null)\n                        continue;\n                    TokenQueue cd = new TokenQueue(value);\n                    String cookieName = cd.chompTo(&quot;=&quot;).trim();\n                    String cookieVal = cd.consumeTo(&quot;;&quot;).trim();\n                    // ignores path, date, domain, validateTLSCertificates et al. req'd?\n                    // name not blank, value not null\n                    if (cookieName.length() &gt; 0)\n                        cookie(cookieName, cookieVal);\n                }\n            } else { // only take the first instance of each header\n                if (!values.isEmpty())\n                    header(name, values.get(0));\n            }\n        }\n    }\"><pre class=\"notranslate\"><code>            List&lt;String&gt; values = entry.getValue();\n            if (name.equalsIgnoreCase(\"Set-Cookie\")) {\n                for (String value : values) {\n                    if (value == null)\n                        continue;\n                    TokenQueue cd = new TokenQueue(value);\n                    String cookieName = cd.chompTo(\"=\").trim();\n                    String cookieVal = cd.consumeTo(\";\").trim();\n                    // ignores path, date, domain, validateTLSCertificates et al. req'd?\n                    // name not blank, value not null\n                    if (cookieName.length() &gt; 0)\n                        cookie(cookieName, cookieVal);\n                }\n            } else { // only take the first instance of each header\n                if (!values.isEmpty())\n                    header(name, values.get(0));\n            }\n        }\n    }\n</code></pre></div>\n"}