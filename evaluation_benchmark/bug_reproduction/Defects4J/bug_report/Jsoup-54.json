{"issue_id": "721", "title": "INVALID_CHARACTER_ERR when converting Document to W3C", "description": "\n<p dir=\"auto\">A recent ClearQuest version has an HTML generation bug, which is ignored by both Chrome and Internet Explorer. Jsoup.parse is also successful:</p>\n<p dir=\"auto\"><code class=\"notranslate\">org.jsoup.nodes.Document doc = Jsoup.parse(\"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body style=\\\"color: red\\\" \\\"&gt;&lt;/body&gt;&lt;/html&gt;\");</code></p>\n<p dir=\"auto\">(Please note the single quotation mark at the end of the body start tag.)</p>\n<p dir=\"auto\">But trying to convert this to a W3C document fails:</p>\n<p dir=\"auto\"><code class=\"notranslate\">new W3CDom().fromJsoup(doc);</code></p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='Exception in thread \"main\" org.w3c.dom.DOMException: INVALID_CHARACTER_ERR: An invalid or illegal XML character is specified. \n    at org.apache.xerces.dom.CoreDocumentImpl.createAttribute(Unknown Source)\n    at org.apache.xerces.dom.ElementImpl.setAttribute(Unknown Source)\n    at org.jsoup.helper.W3CDom$W3CBuilder.copyAttributes(W3CDom.java:124)\n    at org.jsoup.helper.W3CDom$W3CBuilder.head(W3CDom.java:92)\n    at org.jsoup.select.NodeTraversor.traverse(NodeTraversor.java:31)\n    at org.jsoup.helper.W3CDom.convert(W3CDom.java:66)\n    at org.jsoup.helper.W3CDom.fromJsoup(W3CDom.java:46)'><pre class=\"notranslate\"><code>Exception in thread \"main\" org.w3c.dom.DOMException: INVALID_CHARACTER_ERR: An invalid or illegal XML character is specified. \n    at org.apache.xerces.dom.CoreDocumentImpl.createAttribute(Unknown Source)\n    at org.apache.xerces.dom.ElementImpl.setAttribute(Unknown Source)\n    at org.jsoup.helper.W3CDom$W3CBuilder.copyAttributes(W3CDom.java:124)\n    at org.jsoup.helper.W3CDom$W3CBuilder.head(W3CDom.java:92)\n    at org.jsoup.select.NodeTraversor.traverse(NodeTraversor.java:31)\n    at org.jsoup.helper.W3CDom.convert(W3CDom.java:66)\n    at org.jsoup.helper.W3CDom.fromJsoup(W3CDom.java:46)\n</code></pre></div>\n<p dir=\"auto\">Perhaps copyAttributes() should ignore invalid attributes, or catch exactly this error, and ignore it, or W3CDom could have flags to ignore such errors...</p>\n"}