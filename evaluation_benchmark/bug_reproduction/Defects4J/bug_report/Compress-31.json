{"issue_id": "COMPRESS-301", "title": "Illegal argument exception when extracting .tgz file ", "description": "\n<div class=\"user-content-block\">\n<p>When attempting to unpack a .tgz file, I am receiving the illegal argument exception: java.lang.IllegalArgumentException: Invalid byte 0 at offset 5 in '05412</p>\n{NUL}11' len=8. This is causing a java.io.IOException: Error detected parsing the header error. <br/>\n<br/>\nThis is being thrown when the function TarArchiveInputStream.getNextTarEntry() is called. <br/>\n<br/>\nHere is the code I am using. <br/>\n<div class=\"code panel\" style=\"border-width: 1px;\"><div class=\"codeContent panelContent\">\n<pre class=\"code-java\">            TarArchiveInputStream tarIn = <span class=\"code-keyword\">new</span> TarArchiveInputStream(\n                    <span class=\"code-keyword\">new</span> GZIPInputStream(\n                            <span class=\"code-keyword\">new</span> BufferedInputStream(\n                                    <span class=\"code-keyword\">new</span> FileInputStream(\n                                            tempDirPath + fileName))));\n\n            TarArchiveEntry entry = tarIn.getNextTarEntry();\n\n            <span class=\"code-keyword\">while</span> (entry != <span class=\"code-keyword\">null</span>) {\n                File path = <span class=\"code-keyword\">new</span> File(tempDirPath, entry.getName());\n                <span class=\"code-keyword\">if</span> (entry.isDirectory()) {\n                    path.mkdirs();\n                } <span class=\"code-keyword\">else</span> {          \n                    path.createNewFile();\n                    <span class=\"code-object\">byte</span>[] read = <span class=\"code-keyword\">new</span> <span class=\"code-object\">byte</span>[2048];\n                    BufferedOutputStream bout = <span class=\"code-keyword\">new</span> BufferedOutputStream(<span class=\"code-keyword\">new</span> FileOutputStream(path));\n                    <span class=\"code-object\">int</span> len;\n                    <span class=\"code-keyword\">while</span> ((len = tarIn.read(read)) != -1) {\n                        bout.write(read, 0, len);\n                        <span class=\"code-object\">System</span>.out.print(<span class=\"code-keyword\">new</span> <span class=\"code-object\">String</span>(read, <span class=\"code-quote\">\"UTF-8\"</span>));\n                    }\n                    bout.close();\n                    read = <span class=\"code-keyword\">null</span>;\n                }\n                entry = tarIn.getNextTarEntry();\n            }\n            tarIn.close();\n</pre>\n</div></div><br/>\n<br/>\nHere is the full stack trace: <br/>\n<br/>\n<span class=\"error\">[2015-02-12T23:17:31.944+0000]</span> <span class=\"error\">[glassfish 4.0]</span> <span class=\"error\">[SEVERE]</span> [] [] <span class=\"error\">[tid: _ThreadID=123 _ThreadName=Thread-4]</span> <span class=\"error\">[timeMillis: 1423783051944]</span> <span class=\"error\">[levelValue: 1000]</span> [[<br/>\n  java.io.IOException: Error detected parsing the header<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:257)<br/>\n        at org.unavco.ws.tilt.ExtractTiltFile.extractFile(ExtractTiltFile.java:125)<br/>\n        at org.unavco.ws.tilt.ExtractTiltFile.run(ExtractTiltFile.java:59)<br/>\n        at org.unavco.ws.cache.ProcessDataFile.getFileData(ProcessDataFile.java:100)<br/>\n        at org.unavco.ws.cache.ProcessDataFile.getResultSet(ProcessDataFile.java:81)<br/>\n        at org.unavco.ws.tilt.TiltDsClient.write(TiltDsClient.java:47)<br/>\n        at org.glassfish.jersey.message.internal.StreamingOutputProvider.writeTo(StreamingOutputProvider.java:76)<br/>\n        at org.glassfish.jersey.message.internal.StreamingOutputProvider.writeTo(StreamingOutputProvider.java:58)<br/>\n        at org.glassfish.jersey.message.internal.WriterInterceptorExecutor$TerminalWriterInterceptor.aroundWriteTo(WriterInterceptorExecutor.java:194)<br/>\n        at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)<br/>\n        at org.glassfish.jersey.server.internal.JsonWithPaddingInterceptor.aroundWriteTo(JsonWithPaddingInterceptor.java:103)<br/>\n        at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)<br/>\n        at org.glassfish.jersey.server.internal.MappableExceptionWrapperInterceptor.aroundWriteTo(MappableExceptionWrapperInterceptor.java:88)<br/>\n        at org.glassfish.jersey.message.internal.WriterInterceptorExecutor.proceed(WriterInterceptorExecutor.java:139)<br/>\n        at org.glassfish.jersey.message.internal.MessageBodyFactory.writeTo(MessageBodyFactory.java:1005)<br/>\n        at org.glassfish.jersey.server.ServerRuntime$Responder.writeResponse(ServerRuntime.java:471)<br/>\n        at org.glassfish.jersey.server.ServerRuntime$Responder.processResponse(ServerRuntime.java:333)<br/>\n        at org.glassfish.jersey.server.ServerRuntime$Responder.process(ServerRuntime.java:323)<br/>\n        at org.glassfish.jersey.server.ServerRuntime$1.run(ServerRuntime.java:227)<br/>\n        at org.glassfish.jersey.internal.Errors$1.call(Errors.java:271)<br/>\n        at org.glassfish.jersey.internal.Errors$1.call(Errors.java:267)<br/>\n        at org.glassfish.jersey.internal.Errors.process(Errors.java:315)<br/>\n        at org.glassfish.jersey.internal.Errors.process(Errors.java:297)<br/>\n        at org.glassfish.jersey.internal.Errors.process(Errors.java:267)<br/>\n        at org.glassfish.jersey.process.internal.RequestScope.runInScope(RequestScope.java:317)<br/>\n        at org.glassfish.jersey.server.ServerRuntime.process(ServerRuntime.java:198)<br/>\n        at org.glassfish.jersey.server.ApplicationHandler.handle(ApplicationHandler.java:946)<br/>\n        at org.glassfish.jersey.servlet.WebComponent.service(WebComponent.java:323)<br/>\n        at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:372)<br/>\n        at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:335)<br/>\n        at org.glassfish.jersey.servlet.ServletContainer.service(ServletContainer.java:218)<br/>\n        at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1682)<br/>\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:344)<br/>\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:214)<br/>\n        at com.thetransactioncompany.cors.CORSFilter.doFilter(Unknown Source)<br/>\n        at com.thetransactioncompany.cors.CORSFilter.doFilter(Unknown Source)<br/>\n        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)<br/>\n        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:214)<br/>\n        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:316)<br/>\n        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:160)<br/>\n        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:734)<br/>\n        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:673)<br/>\n        at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:99)<br/>\n        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:174)<br/>\n        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:357)<br/>\n        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:260)<br/>\n        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:188)<br/>\n        at org.glassfish.grizzly.http.server.HttpHandler.runService(HttpHandler.java:191)<br/>\n        at org.glassfish.grizzly.http.server.HttpHandler.doHandle(HttpHandler.java:168)<br/>\n        at org.glassfish.grizzly.http.server.HttpServerFilter.handleRead(HttpServerFilter.java:189)<br/>\n        at org.glassfish.grizzly.filterchain.ExecutorResolver$9.execute(ExecutorResolver.java:119)<br/>\n        at org.glassfish.grizzly.filterchain.DefaultFilterChain.executeFilter(DefaultFilterChain.java:288)<br/>\n        at org.glassfish.grizzly.filterchain.DefaultFilterChain.executeChainPart(DefaultFilterChain.java:206)<br/>\n        at org.glassfish.grizzly.filterchain.DefaultFilterChain.execute(DefaultFilterChain.java:136)<br/>\n        at org.glassfish.grizzly.filterchain.DefaultFilterChain.process(DefaultFilterChain.java:114)<br/>\n        at org.glassfish.grizzly.ProcessorExecutor.execute(ProcessorExecutor.java:77)<br/>\n        at org.glassfish.grizzly.nio.transport.TCPNIOTransport.fireIOEvent(TCPNIOTransport.java:838)<br/>\n        at org.glassfish.grizzly.strategies.AbstractIOStrategy.fireIOEvent(AbstractIOStrategy.java:113)<br/>\n        at org.glassfish.grizzly.strategies.WorkerThreadIOStrategy.run0(WorkerThreadIOStrategy.java:115)<br/>\n        at org.glassfish.grizzly.strategies.WorkerThreadIOStrategy.access$100(WorkerThreadIOStrategy.java:55)<br/>\n        at org.glassfish.grizzly.strategies.WorkerThreadIOStrategy$WorkerThreadRunnable.run(WorkerThreadIOStrategy.java:135)<br/>\n        at org.glassfish.grizzly.threadpool.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:564)<br/>\n        at org.glassfish.grizzly.threadpool.AbstractThreadPool$Worker.run(AbstractThreadPool.java:544)<br/>\n        at java.lang.Thread.run(Thread.java:745)<br/>\nCaused by: java.lang.IllegalArgumentException: Invalid byte 0 at offset 5 in '05412{NUL}\n<p>11' len=8<br/>\n        at org.apache.commons.compress.archivers.tar.TarUtils.parseOctal(TarUtils.java:138)<br/>\n        at org.apache.commons.compress.archivers.tar.TarUtils.parseOctalOrBinary(TarUtils.java:169)<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveEntry.parseTarHeader(TarArchiveEntry.java:951)<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveEntry.parseTarHeader(TarArchiveEntry.java:940)<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveEntry.&lt;init&gt;(TarArchiveEntry.java:324)<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:255)<br/>\n        ... 63 more]]</p>\n</div>\n"}