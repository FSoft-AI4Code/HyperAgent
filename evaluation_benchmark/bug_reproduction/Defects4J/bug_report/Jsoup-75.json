{"issue_id": "985", "title": "Regression - Boolean attributes not collapsed when using HTML syntax", "description": "\n<p dir=\"auto\">Hello,</p>\n<p dir=\"auto\">First off, thanks for a really useful library.</p>\n<p dir=\"auto\">So, upgrading from 1.10.2 to 1.11.2 we see that boolean attributes are no longer collapsed when using html syntax. Example test case:</p>\n<div class=\"snippet-clipboard-content notranslate position-relative overflow-auto\" data-snippet-clipboard-copy-content='    @Test\n    public void test() {\n        Document document = Jsoup.parse(\n                \"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;hr size=\\\"1\\\" noshade=\\\"\\\"&gt;&lt;/body&gt;&lt;/html&gt;\");\n        assertEquals(\"&lt;html&gt;\\n\" +\n                     \" &lt;head&gt;&lt;/head&gt;\\n\" +\n                     \" &lt;body&gt;\\n\" +\n                     \"  &lt;hr size=\\\"1\\\" noshade&gt;\\n\" +\n                     \" &lt;/body&gt;\\n\" +\n                     \"&lt;/html&gt;\",\n                     document.outerHtml());\n    }'><pre class=\"notranslate\"><code>    @Test\n    public void test() {\n        Document document = Jsoup.parse(\n                \"&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;hr size=\\\"1\\\" noshade=\\\"\\\"&gt;&lt;/body&gt;&lt;/html&gt;\");\n        assertEquals(\"&lt;html&gt;\\n\" +\n                     \" &lt;head&gt;&lt;/head&gt;\\n\" +\n                     \" &lt;body&gt;\\n\" +\n                     \"  &lt;hr size=\\\"1\\\" noshade&gt;\\n\" +\n                     \" &lt;/body&gt;\\n\" +\n                     \"&lt;/html&gt;\",\n                     document.outerHtml());\n    }\n</code></pre></div>\n<p dir=\"auto\">Tracked it down to commit \"Refactored Attributes to be an array pair vs LinkedHashSet \" <a class=\"commit-link\" data-hovercard-type=\"commit\" data-hovercard-url=\"https://github.com/jhy/jsoup/commit/ea1fb65e9ff8eee82c4e379dc3236d09a5ab02e1/hovercard\" href=\"https://github.com/jhy/jsoup/commit/ea1fb65e9ff8eee82c4e379dc3236d09a5ab02e1\"><tt>ea1fb65</tt></a>. The <code class=\"notranslate\">Attibutes.html(final Appendable accum, final Document.OutputSettings out)</code> method no longer uses <code class=\"notranslate\">Attribute</code> and <strong>fails</strong> to check the value of the attribute for an <em>empty string</em>(line 320).</p>\n<p dir=\"auto\">If I may also suggest to use <code class=\"notranslate\">Attribute.shouldCollapseAttribute(String key, String val, Document.OutputSettings out)</code> instead as a single source of truth as the boolean expression is complex enough and easy to make a mistake. Not sure if this would have an impact in performance though but I am guessing that optimizer will inline the call at some point anyways?</p>\n"}