{"issue_id": "COMPRESS-356", "title": "PAX header entry name ending with / causes problems", "description": "\n<div class=\"user-content-block\">\n<p>There seems to be a problem when a PAX header entry (link flag is 'x') has a name ending with \"/\". The <tt>TarArchiveEntry.isDirectory()</tt> check ends up returning <tt>true</tt> because of the trailing slash which means no content can be read from the entry. PAX header parsing effectively finds nothing and the stream is not advanced; this leaves the stream in a bad state as the next entry's header is actually read from the header contents.</p>\n<p>If the name is modified to remove the trailing slash when the link flag indicates a PAX header everything seems to work fine. That would be one potential fix in <tt>parseTarHeader</tt>. Changing <tt>isDirectory</tt> to return <tt>false</tt> if <tt>isPaxHeader</tt> is <tt>true</tt> (before the trailing \"/\" check) would probably also fix the issue (though I can't verify that in the debugger like I can with changing the name).</p>\n<p>So far I have only seen this when using Docker to save images that contain a yum database. For example:</p>\n<div class=\"preformatted panel\" style=\"border-width: 1px;\"><div class=\"preformattedContent panelContent\">\n<pre>docker pull centos:latest &amp;&amp; docker save centos:latest | tar x --include \"*/layer.tar\"\n</pre>\n</div></div>\n<p>Will produce at least one \"layer.tar\" that exhibits this issue. If I come across a smaller TAR for testing I will attach it.</p>\n</div>\n"}