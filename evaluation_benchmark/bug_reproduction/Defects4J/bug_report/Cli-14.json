{"issue_id": "CLI-144", "title": "adding a FileValidator results in ClassCastException in parser.parseAndHelp(args)", "description": "\n<div class=\"user-content-block\">\n<p>When I add a FileValidator.getExistingFileInstance() to an Argument, I get a ClassCastException when I parse args.</p>\n<p>Below is a testcase invoke with</p>\n<p>   java org.apache.commons.cli2.issues.CLI2Sample -classpath commons-cli-2.0-SNAPSHOT.jar --file-name path-to-an-existing-file</p>\n<p>Run it and you get:</p>\n<p>Exception in thread \"main\" java.lang.ClassCastException: java.io.File cannot be cast to java.lang.String<br/>\n\tat org.apache.commons.cli2.validation.FileValidator.validate(FileValidator.java:122)<br/>\n\tat org.apache.commons.cli2.option.ArgumentImpl.validate(ArgumentImpl.java:250)<br/>\n\tat org.apache.commons.cli2.option.ParentImpl.validate(ParentImpl.java:123)<br/>\n\tat org.apache.commons.cli2.option.DefaultOption.validate(DefaultOption.java:175)<br/>\n\tat org.apache.commons.cli2.option.GroupImpl.validate(GroupImpl.java:264)<br/>\n\tat org.apache.commons.cli2.commandline.Parser.parse(Parser.java:105)<br/>\n\tat org.apache.commons.cli2.commandline.Parser.parseAndHelp(Parser.java:125)<br/>\n\tat org.apache.commons.cli2.issues.CLI2Sample.main(CLI2Sample.java:38)</p>\n<p>Comment out the withValidator call and it runs with no exception. </p>\n<p>I also get a similar ClassCastException if I add a </p>\n<p>  .withValidator(NumberValidator.getIntegerInstance())</p>\n<p>to another option/argument.</p>\n<p>Here is the source</p>\n<p>package org.apache.commons.cli2.issues;</p>\n<p>import java.io.File;<br/>\nimport org.apache.commons.cli2.CommandLine;<br/>\nimport org.apache.commons.cli2.Group;<br/>\nimport org.apache.commons.cli2.builder.ArgumentBuilder;<br/>\nimport org.apache.commons.cli2.builder.DefaultOptionBuilder;<br/>\nimport org.apache.commons.cli2.builder.GroupBuilder;<br/>\nimport org.apache.commons.cli2.commandline.Parser;<br/>\nimport org.apache.commons.cli2.option.DefaultOption;<br/>\nimport org.apache.commons.cli2.validation.FileValidator;</p>\n<p>public class CLI2Sample<br/>\n{<br/>\n   public static void main(String[] args)</p>\n   {\n      final DefaultOptionBuilder obuilder = new DefaultOptionBuilder();\n      final ArgumentBuilder abuilder = new ArgumentBuilder();\n      final GroupBuilder gbuilder = new GroupBuilder();\n      DefaultOption fileNameOption = obuilder\n            .withShortName(\"f\")\n            .withLongName(\"file-name\")\n            .withRequired(true)\n            .withDescription(\"name of an existing file\")\n            .withArgument(abuilder\n                  .withName(\"file-name\")\n                  .withValidator(FileValidator.getExistingFileInstance())\n                  .create())\n            .create();\n      Group options = gbuilder\n            .withName(\"options\")\n            .withOption(fileNameOption)\n            .create();\n      Parser parser = new Parser();\n      parser.setHelpTrigger(\"--help\");\n      parser.setGroup(options);\n      CommandLine cl = parser.parseAndHelp(args);\n     }\n<p>}</p>\n</div>\n"}