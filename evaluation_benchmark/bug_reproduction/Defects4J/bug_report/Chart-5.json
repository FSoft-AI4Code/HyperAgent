{"issue_id": "862", "title": "#862 XYSeries.addOrUpdate() should add if duplicates are allowed\n\n<small>\n<a class=\"icon\" href=\"feed.rss\" rel=\"nofollow\" title=\"Follow this Ticket\"><i class=\"fa fa-rss\"></i></a>\n</small>\n", "description": "\n<div><div class=\"markdown_content\"><p>Copied from this post (by Ted Schwartz) in the forum:</p>\n<p><a href=\"http://www.jfree.org/phpBB2/viewtopic.php?t=24523\" rel=\"nofollow\">http://www.jfree.org/phpBB2/viewtopic.php?t=24523</a></p>\n<p>I've found a bug in jfreechart-1.0.9 code for org.jfree.data.xy.XYSeries. There was a change some time ago which introduced the notion of allowing duplicate X values in XYSeries data. The method addOrUpdate(Number x, Number y) was never modified to support this, and therefore duplicate data were overwriting existing data. This is the fix I've made, but I don't know how to submit a patch...</p>\n<p>$ diff original/jfreechart-1.0.9/source/org/jfree/data/xy/XYSeries.java fixed/org/jfree/data/xy/XYSeries.java<br/>\n537c537<br/>\n&lt; if (index &gt;= 0) {<br/>\n---<br/>\n&gt; if (index &gt;= 0 &amp;&amp; !allowDuplicateXValues) {<br/>\n545a546,559<br/>\n&gt; } else if (index &gt;= 0){<br/>\n&gt; XYDataItem item = new XYDataItem(x, y);<br/>\n&gt; // need to make sure we are adding *after* any duplicates<br/>\n&gt; int size = this.data.size();<br/>\n&gt; while (index &lt; size<br/>\n&gt; &amp;&amp; item.compareTo(this.data.get(index)) == 0) {<br/>\n&gt; index++;<br/>\n&gt; }<br/>\n&gt; if (index &lt; this.data.size()) {<br/>\n&gt; this.data.add(index, item);<br/>\n&gt; }<br/>\n&gt; else {<br/>\n&gt; this.data.add(item);<br/>\n&gt; }<br/>\n558,561d571<br/>\n&lt; // check if this addition will exceed the maximum item count...<br/>\n&lt; if (getItemCount() &gt; this.maximumItemCount) {<br/>\n&lt; this.data.remove(0);<br/>\n&lt; }<br/>\n562a573,576<br/>\n&gt; // check if this addition will exceed the maximum item count...<br/>\n&gt; if (getItemCount() &gt; this.maximumItemCount) {<br/>\n&gt; this.data.remove(0);<br/>\n&gt; }</p></div></div>\n"}