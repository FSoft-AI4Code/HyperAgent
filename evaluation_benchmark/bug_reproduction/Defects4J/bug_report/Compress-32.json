{"issue_id": "COMPRESS-314", "title": "TarArchiveInputStream rejects uid or gid &gt;= 0x80000000", "description": "\n<div class=\"user-content-block\">\n<p>A POSIX-format archive that came from sysdiagnose produces NumberFormatException<span class=\"error\">[1]</span> when I try to read it with TarArchiveInputStream.</p>\n<p>The relevant part of the .tar file looks like this:</p>\n<p>   18 uid=429496729</p>\n<p>That's the uid of 'nobody' on Mac OS (on Mac OS, uid_t is 'unsigned int').</p>\n<p>POSIX doesn't say anything about the width of the uid extended header<span class=\"error\">[2]</span>, so I assume the tar file is okay. GNU tar doesn't have trouble with it.</p>\n<p>The relevant code, in applyPaxHeadersToCurrentEntry:</p>\n<p>            } else if (\"gid\".equals(key))</p>\n{\n                currEntry.setGroupId(Integer.parseInt(val));\n...\n            }\n<p> else if (\"uid\".equals(key)){<br/>\n                currEntry.setUserId(Integer.parseInt(val));</p>\n<p>uid_t and gid_t are typically unsigned 32-bit integers, so these should presumably use Long.parseLong to handle integers with the top bit set (and TarArchiveEntry would need some modifications to handle large uid and gid, too).</p>\n<p><span class=\"error\">[1]</span> java.lang.NumberFormatException: For input string: \"4294967294\"<br/>\n        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)<br/>\n        at java.lang.Integer.parseInt(Integer.java:495)<br/>\n        at java.lang.Integer.parseInt(Integer.java:527)<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.applyPaxHeadersToCurrentEntry(TarArchiveInputStream.java:488)<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.paxHeaders(TarArchiveInputStream.java:415)<br/>\n        at org.apache.commons.compress.archivers.tar.TarArchiveInputStream.getNextTarEntry(TarArchiveInputStream.java:295)</p>\n<p><span class=\"error\">[2]</span> <a class=\"external-link\" href=\"http://pubs.opengroup.org/onlinepubs/9699919799/utilities/pax.html#tag_20_92_13_03\" rel=\"nofollow noopener\" target=\"_blank\">http://pubs.opengroup.org/onlinepubs/9699919799/utilities/pax.html#tag_20_92_13_03</a><br/>\nuid<br/>\nThe user ID of the file owner, expressed as a decimal number using digits from the ISO/IEC 646:1991 standard. This record shall override the uid field in the following header block(s). When used in write or copy mode, pax shall include a uid extended header record for each file whose owner ID is greater than 2097151 (octal 7777777).</p>\n</div>\n"}