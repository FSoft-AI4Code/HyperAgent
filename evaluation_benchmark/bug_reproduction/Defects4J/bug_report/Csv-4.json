{"issue_id": "CSV-100", "title": "CSVParser: getHeaderMap throws NPE ", "description": "\n<div class=\"user-content-block\">\n<p>title nearly says it all <img align=\"absmiddle\" alt=\"\" border=\"0\" class=\"emoticon\" height=\"16\" src=\"/jira/images/icons/emoticons/smile.png\" width=\"16\"/> </p>\n<p>Given a CSVParser parser, the following line throws an NPE:</p>\n<div class=\"code panel\" style=\"border-width: 1px;\"><div class=\"codeContent panelContent\">\n<pre class=\"code-java\">Map&lt;<span class=\"code-object\">String</span>, <span class=\"code-object\">Integer</span>&gt; header = parser.getHeaderMap();\n</pre>\n</div></div>\n<p>Stacktrace: </p>\n<div class=\"preformatted panel\" style=\"border-width: 1px;\"><div class=\"preformattedContent panelContent\">\n<pre>Caused by: java.lang.NullPointerException\nat java.util.HashMap.&lt;init&gt;(HashMap.java:318)\nat java.util.LinkedHashMap.&lt;init&gt;(LinkedHashMap.java:212)\nat org.apache.commons.csv.CSVParser.getHeaderMap(CSVParser.java:288)\n</pre>\n</div></div>\n<p>happens if the format doesn't have a headerMap.</p>\n<p>to fix, check if the parser's headerMap is null before trying to create the returned map:</p>\n<div class=\"code panel\" style=\"border-width: 1px;\"><div class=\"codeContent panelContent\">\n<pre class=\"code-java\"><span class=\"code-keyword\">public</span> Map&lt;<span class=\"code-object\">String</span>, <span class=\"code-object\">Integer</span>&gt; getHeaderMap() {\n    <span class=\"code-keyword\">return</span> <span class=\"code-keyword\">this</span>.headerMap != <span class=\"code-keyword\">null</span> ?\n       <span class=\"code-keyword\">new</span> LinkedHashMap&lt;<span class=\"code-object\">String</span>, <span class=\"code-object\">Integer</span>&gt;(<span class=\"code-keyword\">this</span>.headerMap)\n       : <span class=\"code-keyword\">null</span>;\n}\n\n</pre>\n</div></div>\n</div>\n"}