{"issue_id": "COMPRESS-436", "title": "ZipArchiveInputStream#getNextZipEntry should verify compressed size is known for bzip2, implode etc.", "description": "\n<div class=\"user-content-block\">\n<div class=\"code panel\" style=\"border-width: 1px;\"><div class=\"codeContent panelContent\">\n<pre class=\"code-java\">\r\n        <span class=\"code-keyword\">if</span> (current.entry.getCompressedSize() != ArchiveEntry.SIZE_UNKNOWN) {\r\n            <span class=\"code-keyword\">if</span> (current.entry.getMethod() == ZipMethod.UNSHRINKING.getCode()) {\r\n                current.in = <span class=\"code-keyword\">new</span> UnshrinkingInputStream(<span class=\"code-keyword\">new</span> BoundedInputStream(in, current.entry.getCompressedSize()));\r\n            } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (current.entry.getMethod() == ZipMethod.IMPLODING.getCode()) {\r\n                current.in = <span class=\"code-keyword\">new</span> ExplodingInputStream(\r\n                        current.entry.getGeneralPurposeBit().getSlidingDictionarySize(),\r\n                        current.entry.getGeneralPurposeBit().getNumberOfShannonFanoTrees(),\r\n                        <span class=\"code-keyword\">new</span> BoundedInputStream(in, current.entry.getCompressedSize()));\r\n            } <span class=\"code-keyword\">else</span> <span class=\"code-keyword\">if</span> (current.entry.getMethod() == ZipMethod.BZIP2.getCode()) {\r\n                current.in = <span class=\"code-keyword\">new</span> BZip2CompressorInputStream(<span class=\"code-keyword\">new</span> BoundedInputStream(in, current.entry.getCompressedSize()));\r\n            }\r\n        }\r\n</pre>\n</div></div>\n<p>never sets <tt>current.in</tt> if the compressed size is unknown which probably leads to a NullPointerException in <tt>read</tt> later. We should fail early with a useful error message instead.</p>\n</div>\n"}